<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ABC Notation Renderer with Audio</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/abcjs/6.0.0/abcjs-audio.css">
    <style>
        #abc-container {
            margin: 20px;
        }
        .tune-container {
            margin-bottom: 40px;
        }
    </style>
</head>
<body>
    <h1>ABC Notation Renderer with Audio</h1>
    
    <div id="abc-container"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/abcjs/6.0.0/abcjs-basic.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/abcjs/6.0.0/abcjs-audio.min.js"></script>
    <script>
        // Combined ABC notation data
        const abcNotation = `
        X: 1
        T: Salamanca
        M: 4/4
        K: Dmajor
        |:dB|ADFD ADFD|Adcd fdcd|BEGE BEGE|Bded cdeg|
        fBAB fBAB|fafc deag|fdec dBAG|FGEF D2:|
        |:fg|afdg bgeg|fdec dcBc|ABcd defg|a2^gb a2f=g|
        afff geee|fdec dfag|fdec dBAG|FGEF D2:|

        X: 2
        T: Banshee
        M: 4/4
        K: Gmajor
        |:G2 GD EDEG|AGAB d2 Bd|eged BAGA|BAGE EDDE|
        G2 GD EDEG|AGAB d2 Bd|eged BAGA|BAGE ED D2:|
        |:ea a2 efgf|eBBA B2 Bd|eB B2 efgf|eBBA B2 Bd|
        ea a2 efgf|eBBA B2 Bd|eged BAGA|BAGE EDD2:|

        X: 3
        T: Sailor's Bonnet
        M: 4/4
        K: Dmajor
        A2 FA d~f3|dfef d~B3|A2 FA dfef|1 dBAF ADDB:|2 dBAF ADD2||
        |:~a3 a afef|afef d~B3|fb (3bbb bafa|bfaf feef|
        b~f3 afed|afef d~B3|(3ABA FA dfef|1 dBAF ADD2:|2 dBAF ADDB||
        `;

        // Function to render ABC notation and set up audio
        function renderABC() {
            // Split the ABC notation into individual tunes
            const tunes = abcNotation.trim().split(/\n\s*\n/); // Split by double newline
            
            // Iterate through each tune and render
            tunes.forEach((tune, index) => {
                // Create a container for each tune
                const tuneContainer = document.createElement('div');
                tuneContainer.className = 'tune-container';
                
                // Render ABC notation
                ABCJS.renderAbc(tuneContainer, tune, { responsive: 'resize' });
                
                // Create an audio button for each tune
                const button = document.createElement('button');
                button.textContent = 'Play';
                button.onclick = () => {
                    ABCJS.sounds.play(tune);
                };
                
                // Append audio player and rendered notation to the tune container
                tuneContainer.appendChild(button);
                document.getElementById('abc-container').appendChild(tuneContainer);
            });
            ABCJS.sounds.play(tunes[0])
            ABCJS.sounds.play(tunes[1])
        }
        function onMidi() {
          if (ABCJS.synth.supportsAudio()) {
            var visualObj = ABCJS.renderAbc('notation', cooleys)[0];
            var synthControl = new ABCJS.synth.SynthController();
            synthControl.load("#audio", null, {displayRestart: true, displayPlay: true, displayProgress: true});
            synthControl.setTune(visualObj, false);
          } else {
            document.querySelector("#audio").innerHTML = "<div class='audio-error'>Audio is not supported in this browser.</div>";
          }
        }

        function onRender(tune, params) {
          if (!params) params = {};
          ABCJS.renderAbc('notation', tune, params);
          document.getElementById("audio").innerHTML = "";
        }


        // Call the render function
        renderABC();
    </script>
</body>
</html>
